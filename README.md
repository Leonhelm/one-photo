# Приложение **onePhoto**

## Цель и задачи

**onePhoto** — лёгкое веб-приложение для быстрого просмотра 10 последних загруженных фотографий из Microsoft OneDrive независимо от того, в какой папке они хранятся.

## Функциональная архитектура

1. **Страница логина (/login)**  
   - Кнопка «Войти через Microsoft»  
   - Вызов MSAL-Node для получения OAuth токена  
   - Сохранение токена в оперативной памяти (React Context)  
   - Перенаправление на `/photos` после успешного входа

2. **Страница фотогалереи (/photos)**  
   - При монтировании компонента берётся accessToken из памяти  
   - Запрос к Graph API:
     ```ts
     client
       .api('/me/drive/root/search(q=\'.jpg\')?orderby=lastModifiedDateTime desc&top=10')
       .get()
     ```
   - Вывод 10 превью изображений в сетке MUI `<ImageList>`  
   - Обработка ошибок авторизации (401 → редирект на `/login`)

## User Stories

- **US1**: Как пользователь, я хочу нажать «Войти через Microsoft» и увидеть галерею своих фото.
- **US2**: Как пользователь, я хочу, чтобы данные моего токена хранились только пока открыта вкладка.
- **US3**: Как пользователь, я хочу видеть ровно 10 самых новых фотографий, даже если они в разных папках.

## Нефункциональные требования

- **Безопасность**: токен не должен сохраняться в постоянном хранилище браузера.
- **Отказоустойчивость**: при ошибке API пользователь должен видеть сообщение и возможность повторить.
- **Производительность**: время загрузки страницы `/photos` не более 2 секунд (при нормальной сети).
- **Кросс-браузерность**: поддержка последних версий Chrome, Edge, Firefox, Safari.

## Технический стек

- **Фреймворк**: Next.js (v15+) с TypeScript (v5+)
- **Стилизация**: @mui/material (v7+)  
- **Авторизация**: @azure/msal-node  
- **API-клиент**: @microsoft/microsoft-graph-client  
- **Хранение состояния**: React Context + хук useState/useReducer  
- **Сборка**: Vercel

## План разработки

- [x] Инициализировать проект на Next.js с TypeScript  
- [x] Создать страницу `/login` с кнопкой входа и логикой авторизации  
- [x] Установить MSAL-Node и настроить OAuth авторизацию через Microsoft  
- [x] Реализовать хранение токена в памяти с использованием React Context  
- [x] Установить и настроить Material UI  
- [ ] Создать защищённый маршрут `/photos`, доступный только после входа  
- [ ] Подключить Microsoft Graph API через `@microsoft/microsoft-graph-client`  
- [ ] Реализовать загрузку 10 последних фотографий через Graph API  
- [ ] Вывести фотографии в виде сетки через MUI `<ImageList>`  
- [ ] Обработать ошибки авторизации и перенаправлять на `/login` при невалидной сессии  
- [ ] Добавить базовую валидацию и сообщения об ошибках  
- [ ] Написать юнит-тесты для сервисов авторизации и API  
- [ ] Настроить деплой и переменные среды для продакшена (Vercel)
